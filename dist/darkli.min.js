!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Darkli=e()}(this,function(){"use strict";function t(t){var e=window.location.href,n=t.replace(/[[\]]/g,"\\$&"),i=new RegExp("[?&]"+n+"(=([^&#]*)|&|#|$)").exec(e);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}function e(t){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:document).querySelector(t)}function n(t){var e,n=function(t,e,n){var i=new RegExp("([?&])"+e+"=.*?(&|$)","i"),o=-1!==t.indexOf("?")?"&":"?";return t.match(i)?t.replace(i,"$1"+e+"="+n+"$2"):t+o+e+"="+n}(document.URL,"darkli",t);window.history.pushState(t,null,n),this.config.box.classList.add("is-active");var i=["is-active"];this.config.heightAuto&&i.push("is-height-auto"),(e=this.config.box.querySelector("[data-darkli-content="+t+"]").classList).add.apply(e,i)}var i={box:".darkli",contents:".darkli-content",btnOpens:"[data-darkli]",btnClose:".darkli .darkli-close",heightAuto:!1},o=/(youtube(-nocookie)?\.com|youtu\.be)\/(watch\?v=|v\/|u\/|embed\/?)?([\w-]{11})(.*)?/i,r=function(t){return'\n  <div class="darkli-iframe-container">\n    <iframe frameborder="0" src="'+t+'" allowfullscreen></iframe>\n  </div>\n'},a=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},c=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(t,e){e=e||window;for(var n=0;n<this.length;n++)t.call(e,this[n],n,this)}),Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var s=function(){function s(t){a(this,s),this.version="0.4.1",this.author="Rex Tsou <akccakccwww@gmail.com>",this.bugs="https://github.com/akccakcctw/darkli/issues",this.license="WTFPL",this.moduleName="darkli",this.config=Object.assign(i,t),this.init()}return c(s,[{key:"open",value:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];n.apply(this,e)}},{key:"close",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];(function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.config.box.classList.contains("is-active")&&(this.config.box.classList.remove("is-active"),this.config.box.querySelectorAll(".darkli-content").forEach(function(t){t.classList.contains("auto-destroy")&&t.parentNode.removeChild(t),t.classList.remove("is-active")}),!0===t&&window.history.go(-1))}).apply(this,e)}},{key:"create",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.box,n=void 0===e?this.config.box:e,i=t.isExternal,o=void 0!==i&&i,r=t.autoDestroy,a=void 0!==r&&r,c=t.content,s=(+new Date).toString(36),l=document.createElement("div");l.classList.add("darkli-content"),l.setAttribute("data-darkli-content",s),o&&l.classList.add("is-external"),a&&l.classList.add("auto-destroy"),l.innerHTML=c,n.appendChild(l),this.open(s)}).apply(this,e)}},{key:"external",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];(function(t){o.exec(t)&&this.create({content:r(t),isExternal:!0,autoDestroy:!0})}).apply(this,e)}},{key:"init",value:function(){var n=this;if(Object.assign(this.config,{box:e(this.config.box),btnOpens:function(t){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:document).querySelectorAll(t)}(this.config.btnOpens),btnClose:e(this.config.btnClose)}),null==this.config.box)throw new Error("config.box cannot be null");Array.from(this.config.btnOpens).forEach(function(t){return t.addEventListener("click",function(){t.dataset.darkli?n.open(t.dataset.darkli):n.external(t.getAttribute("href"))})}),t(this.moduleName)&&this.open(t(this.moduleName));return function(){var t=function(t,e){var n=document.createElementNS("http://www.w3.org/2000/svg","svg"),i=n.namespaceURI,o=document.createElementNS(i,t);return Object.keys(e).forEach(function(t){o.setAttribute(t,e[t])}),n.appendChild(o),n}("polygon",{points:"612,36.004 576.521,0.603 306,270.608 35.478,0.603 0,36.004 270.522,306.011 0,575.997 35.478,611.397      306,341.411 576.521,611.397 612,575.997 341.459,306.011    "});t.classList.add("darkli-icon"),t.setAttribute("viewBox","0 0 612 612"),n.config.btnClose.appendChild(t)}(),this.config.btnClose.addEventListener("click",function(){n.close()}),document.addEventListener("mouseup",function(t){var i=e(".darkli .darkli-content");t.target.matches(".darkli .darkli-content")||i.contains(t.target)||n.close()}),document.addEventListener("keyup",function(t){27!==t.keyCode&&8!==t.keyCode||n.close()}),window.addEventListener("popstate",function(){n.close(!1)}),this}}],[{key:"noConflict",value:function(){return window.darkli=void 0,s}}]),s}();return"undefined"==typeof exports&&void 0!==window.darkli&&(console.log("darkli already defined. Rename it as `Otherdarkli`"),window.Otherdarkli=window.darkli,window.darkli=s),s});